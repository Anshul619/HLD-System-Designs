# API Performance & Scalability Optimization Playbook

This is a production-grade scalability checklist covering:
- Database scalability
- Application-layer scalability
- Infrastructure auto-scaling
- Architecture-level scalability patterns
- Failure isolation & load control mechanisms

> Legend
> - (Architecture) → Advanced design patterns, usually requiring infra or system-level changes.
> - Priority: High → quick wins / immediate impact, Medium → medium effort, Low → micro-optimizations.

# How to Use This Checklist?
- Start with High Priority items in *Identify & fix DB issues* and *Reduce unnecessary load*.
- Move on to improve resilience & scalability items for system stability.
- Consider **(Architecture)** points when planning larger design changes.
- Each row links to a deep dive in this repo or an external reference.

# Scalability Principles Table

| Principle                                         | Priority | Tag                                                   | Remarks                                                                                                                                                                                                                                                                                           |
|---------------------------------------------------|----------|-------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Ensure Observability                              | High     | Pre-tuning requirement                                | [Observability](https://github.com/Anshul619/DevOps-SRE/blob/main/3_Observability), [Structured Logging](https://github.com/Anshul619/DevOps-SRE/blob/main/3_Observability/StructuredLogging.md), [profiling in Go](https://github.com/Anshul619/Golang/tree/main/Debugging%26Profiling) etc.     |
| Profile Slow Query logs & tune                    | High     | Identify & fix DB issues (SQL-focused)                | Observe [Slow Query logs](https://severalnines.com/blog/how-identify-mysql-performance-issues-slow-queries/) to find poorly performing queries before making other changes.<br/>- Tune identified DB queries to remove inefficiencies and improve execution time.                                 |
| Understand query planner                          | High     | Identify & fix DB issues (SQL-focused)                | Learn to read and interpret execution plans to pinpoint query bottlenecks.                                                                                                                                                                                                                        |
| Indexing                                          | High     | Identify & fix DB issues (SQL-focused)                | [Index the right columns](../1_Databases/5_Database-Internals/Indexing.md) to improve reads. <br/>- Index columns used in *WHERE, JOIN, HAVING, ORDER BY, GROUP BY*.                                                                                                                              |
| Avoid N+1 Query pattern                           | High     | Identify & fix DB issues (SQL-focused)                | Replace multiple small queries with batched or joined queries to reduce DB round trips.                                                                                                                                                                                                           |
| NoSQL-specific query tuning tips                  | High     | Identify & fix DB issues (NoSQL-focused)              | Optimize NoSQL queries using vendor-specific techniques (e.g. compound indexes in MongoDB, query filters in DynamoDB, partition keys in Cassandra).                                                                                                                                               |
| Caching                                           | High     | Reduce unnecessary load                               | Use [redis](../1_Databases/8_Caching-InMemory-Databases/Redis/Readme.md), to cache frequently accessed read data and reduce DB hits.<br/>- Avoid caching large datasets that can degrade performance.                                                                                             |
| Pagination                                        | High     | Reduce unnecessary load                               | Break large API response into [pages](../8_API-Protocols/Concepts/Pagination.md) using limit & offset (relay based) or cursors to prevent massive payloads.                                                                                                                                       |
| Tune Service tasks count & auto-scale             | High     | Improve resilience & scalability                      | Right-size the number of service tasks (i.e. ECS Fargate tasks) to handle expected throughput without over-provisioning. <br/>- Use CPU/memory utilization or queue depth for auto-scaling.                                                                                                       |
| DB Connection Pooling                             | High     | Improve resilience & scalability                      | Maintain a pool of connections (with timeouts, max idle connections), instead of opening a new connection for every API request. <br/>- This would prevent **connection storms** or **resource exhaustion**.                                                                                      |
| Use concurrency & async processing                | High     | Improve resilience & scalability                      | Offload long-running or non-blocking tasks using [goroutines](https://github.com/Anshul619/Concurrency-Go/tree/main/GoRoutines.md), *worker pools*, or *async job execution*. <br/>- For inter-service async communication, use [message brokers (Kafka, RabbitMQ, SQS)](../2_MessageBrokersEDA). |
| Handle timeout                                    | High     | Improve resilience & scalability                      | Use proper timeouts (e.g. [Go Contexts](https://github.com/Anshul619/Concurrency-Go/tree/main/Context)) to prevent cascading failures when upstream services fail or close connections early.                                                                                                     |
| Graceful degradation / feature toggles            | High     | Improve resilience & scalability                      | Temporarily disable non-essential or heavy features during peak load to keep core functionality responsive.                                                                                                                                                                                       |
| Backpressure handling                             | High     | Improve resilience & scalability                      | Implement load-shedding or **rate-limiting** to protect services under overload (e.g. HTTP 429, queue throttling).                                                                                                                                                                                |
| Avoid unnecessary or poorly indexed joins         | Medium   | Identify & fix DB issues (SQL-focused)                | Optimize joins by ensuring proper indexing and only joining necessary tables. <br/>- Removing all joins isn’t always beneficial.                                                                                                                                                                  |
| Prevent having JSON columns                       | Medium   | Identify & fix DB issues (SQL-focused)                | Avoid JSON/JSONB columns for frequently filtered data. They are slower to query and harder to index efficiently. [Read more](https://stackoverflow.com/questions/71086258/query-on-json-jsonb-column-super-slow-can-i-use-an-index).                                                              |
| Materialized Views, De-normalization              | Medium   | Identify & fix DB issues (SQL-focused)                | Precompute heavy queries or flatten data where real-time joins are too costly.                                                                                                                                                                                                                    |
| Regular Vacuum                                    | Medium   | Identify & fix DB issues (SQL-focused)                | [Vacuum](https://www.postgresql.org/docs/current/sql-vacuum.html) regularly in PostgreSQL to prevent bloat and maintain healthy performance in high-churn tables.                                                                                                                                 |
| Minimize select columns                           | Low      | Reduce unnecessary load                               | Fetch only the columns you need - reduces network and memory usage for large datasets.                                                                                                                                                                                                            |
| Compression (payload-level)                       | Low      | Reduce network cost                                   | Apply compression for large payloads to reduce bandwidth - avoid overusing on small payloads to save CPU.                                                                                                                                                                                         |
| Asynchronous logging                              | Low      | Reduce blocking operations                            | Buffer logs in memory and flush asynchronously to avoid blocking request processing with I/O operations.                                                                                                                                                                                          |
| JSON Serialization                                | Low      | Reduce CPU cost                                       | Consider faster [JSON serialization library](https://github.com/Anshul619/Serialization-Data) for JSON-heavy APIs to reduce CPU time spent on encoding/decoding.                                                                                                                                  |
| Use CDN to cache static resources                 | Medium   | Reduce unnecessary load (Architecture)                | Use a [CDN](CDNs) to cache and serve static assets (images, CSS, JS) close to users, reducing server load and improving response times.                                                                                                                                                           |
| Data archiving (hot vs cold storages)             | Medium   | Reduce unnecessary load / storage cost (Architecture) | [Move old/infrequently accessed data](../1_Databases/3_Scalability-Techniques/DataArchiving.md) to cold storage (e.g. S3, Glacier) to reduce hot DB size and improve query performance.                                                                                                           |
| Read Replicas                                     | Medium   | Improve resilience & scalability (Architecture)       | Use [read replicas](../1_Databases/3_Scalability-Techniques/ReadReplicaVsCache.md) to offload read traffic from the primary database.                                                                                                                                                             |
| Sharding                                          | Medium   | Improve resilience & scalability (Architecture)       | Distribute data across multiple shards to improve [horizontal scalability](../1_Databases/3_Scalability-Techniques/PartitioningSharding), consider complexity and operational cost before implementing.                                                                                           |
| Use appropriate databases based on query patterns | Medium   | Improve resilience & scalability (Architecture)       | Choose the right DB engine for your [access patterns](../1_Databases/DatabaseDesign.png) — SQL for relational joins, Elasticsearch for search, MongoDB/DynamoDB for document or key-value access.                                                                                                 |
| Choose appropriate architecture style             | Medium   | Improve resilience & scalability (Architecture)       | Decide between [monolith and microservices](../3_MicroServices/MonoToMicroServices.md) based on expected scale, team structure, and latency tolerance. <br/>- Avoid premature microservices, as network costs can hurt.                                                                           |
| Async batch processing for heavy workloads        | Medium   | Improve resilience & scalability (Architecture)       | Move heavy [aggregation/analytics tasks](../1_Databases/OLTPvsOTAP.md) to asynchronous jobs instead of real-time APIs to keep request latency low.                                                                                                                                                |

# Related Deep Dives in This Folder
- [Latency](Latency.md)
- [Throughput](Throughput.md)
- [CDNs](CDNs)

# Read more
- [Top 7 Ways to 10x Your API Performance](https://www.youtube.com/watch?v=zvWKqUiovAM)
- [SQL Tunning - Donnemartin](https://github.com/donnemartin/system-design-primer#sql-tuning)
- [Understanding caching in Postgres - An in-depth guide](https://madusudanan.com/blog/understanding-postgres-caching-in-depth/)
- [Tuning Input/Output (I/O) Operations for PostgreSQL](https://severalnines.com/blog/tuning-io-operations-postgresql/)
- [Secret To Optimizing SQL Queries - Understand The SQL Execution Order](https://www.youtube.com/watch?v=BHwzDmr6d7s)
- [Analyzing Amazon RDS Database Workloads with Performance Insights](https://aws.amazon.com/blogs/database/analyzing-amazon-rds-database-workload-with-performance-insights/)
- [How does SQL trigger affect performance?](https://stackoverflow.com/questions/56990262/how-does-sql-trigger-affect-performance)