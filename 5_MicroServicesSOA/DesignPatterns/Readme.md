# Microservices - Design Patterns

|                                                 | Type                         | Remarks                                                                                                                                                                                                                                                                                            |
|-------------------------------------------------|------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| :star: Database per service                     | Data management              | Each service has its [own private database](https://microservices.io/patterns/data/database-per-service.html). Each service stores and processes data related to a single business function.                                                                                                       |
| :star: Local cache using Redis                  | Data management              | Microservices can cache the data locally in [Redis](../../3_DatabaseServices/8_InMemory-Databases/Redis), instead of requesting data from another service everytime.                                                                                                                               |
| Domain Driven Design                            | Data management              | Classes, modals, services, microservices, rest apis etc. should be designed according to the [domains](../../7b_ArchitecturePatterns/DomainDrivenArchitecture.md).                                                                                                                                 |
| Distributed Transaction - Saga Pattern          | Data management              | If a local transaction fails because it violates a business rule then the [saga](Saga.md) executes a series of compensating transactions that undo the changes that were made by the preceding local transactions.                                                                                 |
| Distributed Transaction - Transactional outbox  | Data management              | Service that sends the message to first store the message in the database as part of the transaction that updates the business entities. A separate process then sends the messages to the message broker. [Read more](https://microservices.io/patterns/data/transactional-outbox.html)           |
| Command Query Responsibility Segregation (CQRS) | Data management              | [CQRS](CQRS.md) define a view database, which is a **read-only replica** that is designed to support that query.                                                                                                                                                                                   |
| Event sourcing                                  | Data management              | [Event sourcing](EventSourcing.md) persists the state of a business entity such an Order or a Customer as a sequence of state-changing events.                                                                                                                                                     |
| Asynchronous Messaging                          | Communication - Style        | In asynchronous messaging, [Message Brokers](../../4_MessageBrokersEDA) are used to pass events b/w microservices. [Read more](https://microservices.io/patterns/communication-style/messaging.html)                                                                                               |
| Synchronous Messaging                           | Communication - Style        | In synchronous messaging/request/reply-based protocol, [gRPC](../../8_APIStandards/gRPC.md) or [REST](../../8_APIStandards/REST.md) are used for inter-service communication.                                                                                                                      |
| Circuit Breaker                                 | Reliability                  | In [circuit breaker](../../7b_ArchitecturePatterns/CircuitBreaker.md), a remote service is invoked via a proxy that fails immediately when the failure rate of the remote call exceeds a threshold.                                                                                                |
| Retry & timeout pattern                         | Reliability                  | Do only the limited numbers of [retry](../../7b_ArchitecturePatterns/RetryPattern.md) on failure and make a timeout after retry.                                                                                                                                                                   |
| API Gateway                                     | Communication - External API | [API gateway](../1_APIGateway/Readme.md) provides each client with unified interface to services. [Read more](https://microservices.io/patterns/apigateway.html)                                                                                                                                   |
| Service Registry & discovery                    | Communication                | The router queries a [service registry](../2_ServiceRegistry&Discovery/Readme.md) (a database of service instance locations) to discover the locations of service instances. [Read more](https://microservices.io/patterns/server-side-discovery.html)                                             |
| Logging & monitoring                            | Observability                | [New Relic](../../12_ObservabilityServices/NewRelic/Readme.md), [ELK](../../12_ObservabilityServices/ELK.md) etc can be used for logging and observation of microservices. [Read more](https://microservices.io/patterns/observability/application-logging.html)                                   |
| Distributed Tracing                             | Observability                | [New Relic](../../12_ObservabilityServices/NewRelic/Readme.md), [AWS AppMesh](../../2_AWSServices/1_NetworkingAndContentDelivery/2_ApplicationNetworking/AWSAppMesh.md) can be used as [service mesh](../3_ServiceMesh.md) for distributed tracing.                                                |
| Service instance per container                  | Deployment patterns          | Use [Container orchestration service](../../9_Container&OrchestrationServices/Readme.md) for container deployments. Example - [Kubernates](../../9_Container&OrchestrationServices/Kubernates/Readme.md), [AWS ECS](../../2_AWSServices/4_ContainerOrchestrationServices/AmazonECS/Readme.md) etc. |
| Session                                         | Security                     | [Redis](../../3_DatabaseServices/8_InMemory-Databases/Redis) can be used to share the session data between microservices.                                                                                                                                                                          |
| Access token                                    | Security                     | [API Gateway](../1_APIGateway/Readme.md) authenticates the request and passes an access token (e.g. JSON Web Token) that securely identifies the requester in each request to the services. <br/>- A service can include the access token in requests it makes to other services.                  |

# Read more
- [A pattern language for microservices](https://microservices.io/patterns/)
- [Microservice Pitfalls: Solving the Dual-Write Problem | Designing Event-Driven Microservices](https://www.youtube.com/watch?v=4GffyiSZri4)

