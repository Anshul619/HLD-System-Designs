
# Various Message Brokers

| Basis                                    | :star: [Kafka](Kafka/Readme.md)                                                            | [Amazon Kinesis Data Streams](https://github.com/Anshul619/AWS-Services/tree/main/4_MessageBrokers/AmazonKinesis/Readme.md)                                                                              | :star:[Amazon SQS](https://github.com/Anshul619/AWS-Services/tree/main/4_MessageBrokers/AmazonSQS/Readme.md)                                                                                                  | [Amazon SNS](https://github.com/Anshul619/AWS-Services/tree/main/4_MessageBrokers/AmazonSNS.md)                                                                | [Amazon EventBridge](https://github.com/Anshul619/AWS-Services/tree/main/4_MessageBrokers/AmazonEventBridge.md)                                              | [RabbitMQ](RabbitMQ.md)                                                                                                                         |
|------------------------------------------|--------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| Event storage structure                  | :sunglasses: [Logs](../1_Databases/5_Database-Internals/AppendOnlyProperty.md)              | :sunglasses: [Logs](../1_Databases/5_Database-Internals/AppendOnlyProperty.md)                                                                                        | Queue                                                                                                                                                                     | Topic                                                                                                                      | Event Bus                                                                                                                | Queue                                                                                                                                           |
| Strength                                 | High-Throughput Broker, Events Streaming.                                                  | AWS Managed Service for events streaming.                                                                                                                            | Decouple & scale microservices, serverless applications                                                                                                                   | Push-Notification-Based-Broker, can't be used for events streaming.                                                        | Rule-Based-Targeting-Broker                                                                                              | Low-Latency MQ                                                                                                                                  |
| Throughput (write)                       | :rocket: [Up to 1 million messages per second]()                                           | [Up to 1000 messages/sec per shard](https://docs.aws.amazon.com/streams/latest/dev/key-concepts.html)                                                                | [Nearly unlimited or up to 30K messages per second](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/quotas-messages.html) <br/>(Standard queue) | [Up to 30K messages per second](https://docs.aws.amazon.com/general/latest/gr/sns.html) <br/>(Standard topic)              | [Up to 10K messages per second](https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-quota.html)                  | [Up to 10K messages per second](https://blog.rabbitmq.com/posts/2012/04/rabbitmq-performance-measurements-part-2)                               |
| Latency (message visibility to Consumer) | ~5ms                                                                                       | [Less than 1 sec](https://docs.aws.amazon.com/streams/latest/dev/kinesis-low-latency.html)                                                                           | Less than 100 ms                                                                                                                                                          | b/w 100 ms to 200 ms                                                                                                       | Greater than 200ms                                                                                                       | ~1ms                                                                                                                                            |
| Message Transfer Model                   | [Pub-Sub](EventDrivenArchitecture/PubSubModel.md)                                          | [Pub-Sub](EventDrivenArchitecture/PubSubModel.md)                                                                                                                    | [Point-2-Point](EventDrivenArchitecture/PointToPointModel.md)                                                                                                             | [Pub-Sub](EventDrivenArchitecture/PubSubModel.md)                                                                          | [Pub-Sub](EventDrivenArchitecture/PubSubModel.md)                                                                        | [Point-2-Point](EventDrivenArchitecture/PointToPointModel.md)                                                                                   |
| Consumption Model                        | Pull Based                                                                                 | Pull Based                                                                                                                                                           | Pull Based                                                                                                                                                                | Push Based, Upto 100K topics, 10 million subscribers per topic                                                             | Push Based, Upto 100 event buses, 300 rules per event bus, 5 targets per rule                                            | Push Based                                                                                                                                      |
| Use Cases                                | High Throughput / Massive data events streaming (like analytics)                           | Website click-streams, database event streams, financial transactions, social media feeds, IT logs, and location-tracking events etc.                                | [Point-2-Point modeling in event-driven microservices](EventDrivenArchitecture/Readme.md).                                                                                | Notification (Email/Push) to person, Pub-Sub modeling for [event-driven microservices](EventDrivenArchitecture/Readme.md). | Rule based targeting in [Event-driven microservices](EventDrivenArchitecture/Readme.md)                                  | Low-latency use cases when message guarantee is needed or some consistent behaviour (like order workflow, failed orders etc.)                   |
| Consumer Type                            | :sunglasses: Smart <br/>(Consumers maintain their own state)                               | :sunglasses: Smart <br/>(Consumers maintain their own state)                                                                                                         | :sunglasses: Smart <br/>(Consumers need to be identical & delete message once consumed)                                                                                   | Dump <br/>(Consumers might be processing messages in the different way)                                                    | Dump<br/>(Consumers might be processing messages in the different way)                                                   | Dumb                                                                                                                                            |
| Broker/Publisher Type                    | Dump                                                                                       | Dump                                                                                                                                                                 | Dump                                                                                                                                                                      | :sunglasses: Smart                                                                                                         | :sunglasses: Smart                                                                                                       | :sunglasses: Smart <br/>(Consistent transmission of messages to consumers at about the same speed as the broker monitors the consumer's status) |
| Persistence/Lifetime Of Messages         | :white_check_mark: Yes <br/>- Messages are retained as much as needed (& can be replayed). | :white_check_mark: Yes <br/>- Messages are [retained from 24 hrs to 365 days](https://docs.aws.amazon.com/streams/latest/dev/key-concepts.html). (& can be replayed) | :white_check_mark: Yes, max 14 days. <br>- Once message is consumed, it would be removed.                                                                                 | :x: No <br> - When an SNS Topic receives an event notification, it would be instantly broadcast to all Subscribers.        | :x: No <br/>- But events can be archived, to replay later.                                                               | :x: No <br/>- Once message is consumed and acknowledgement is sent, it would be removed from RabbitMQ message queue.                            |
| Ordering Of Messages                     | :white_check_mark: Supported <br/>(using partition key)                                    | :white_check_mark: [Supported (using partition key)](https://docs.aws.amazon.com/streams/latest/dev/key-concepts.html)                                               | :white_check_mark: Supported (in FIFO SQS Queues)                                                                                                                         | :white_check_mark: Supported (in FIFO SNS Topics)                                                                          | :x: Not-Supported                                                                                                        | :x: Not-Supported                                                                                                                               |
| Payload Size                             | Upto 1MB size                                                                              | Up to 1MB size                                                                                                                                                       | [Up to 256K size](https://docs.aws.amazon.com/general/latest/gr/sqs-service.html)                                                                                         | [Up to 256K size](https://aws.amazon.com/blogs/compute/choosing-between-messaging-services-for-serverless-applications/)   | [Up to 256K size](https://aws.amazon.com/blogs/compute/choosing-between-messaging-services-for-serverless-applications/) | No constraints                                                                                                                                  |
| Pricing Model                            | Open Source <br/>([Amazon MSK](https://github.com/Anshul619/AWS-Services/tree/main/4_MessageBrokers/AmazonMSK.md) on AWS)      | AWS Managed Service                                                                                                                                                  | $0.4 per million API calls <br/>(AWS Managed Service)                                                                                                                     | $0.5 per million API calls <br/>(AWS Managed Service)                                                                      | $1 per million API calls <br/>(AWS Managed Service)                                                                      | Open Source <br/>([Amazon MQ](https://github.com/Anshul619/AWS-Services/tree/main/4_MessageBrokers/AmazonMQ.md) on AWS)                                                             |

# References
- [Choosing the right event-routing service for serverless: EventBridge, SNS, or SQS](https://lumigo.io/blog/choosing-the-right-event-routing-on-aws-eventbridge-sns-or-sqs/)
- [Top 5 reasons to use EventBridge instead of SNS](https://lumigo.io/blog/5-reasons-why-you-should-use-eventbridge-instead-of-sns/)
- [Choosing between messaging services for serverless applications](https://aws.amazon.com/blogs/compute/choosing-between-messaging-services-for-serverless-applications/)
- [AWS SQS vs SNS vs Eventbridge – When to Use What?](https://beabetterdev.com/2021/09/10/aws-sqs-vs-sns-vs-eventbridge/)
- [Kinesis vs Kafka: Comparing Two Popular Streaming Analytics Tools](https://www.spec-india.com/blog/kinesis-vs-kafka)
- [Kafka vs Kinesis: How to Choose](https://rockset.com/blog/kafka-vs-kinesis-choosing-the-best-data-streaming-solution/)
- [RabbitMQ vs Kafka - InterviewBit](https://www.interviewbit.com/blog/rabbitmq-vs-kafka/)
- [Benchmarking Apache Kafka and RabbitMQ: Which is the Fastest?](https://www.confluent.io/blog/kafka-fastest-messaging-system/)