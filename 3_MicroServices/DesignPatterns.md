# Microservices - Design Patterns

|                                                 | Type                         | Remarks                                                                                                                                                                                                                                                                                            |
|-------------------------------------------------|------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| :star: Database per service                     | Data management              | Each service has its [own private database](https://microservices.io/patterns/data/database-per-service.html). Each service stores and processes data related to a single business function. ([share nothing architecture](../7_ArchitecturePatterns/SharedNothingArchitecture.md))            |
| :star: Local cache using Redis                  | Data management              | Microservices can cache the data locally in [Redis](../1_Databases/8_Caching-InMemory-Databases/Redis), instead of requesting data from another service everytime.                                                                                                                               |
| Domain Driven Design                            | Data management              | Classes, modals, services, microservices, rest apis etc. should be designed according to the [domains](https://github.com/Anshul619/LLD-OOPs-Design-Patterns/tree/main/DomainDrivenDevelopment/Readme.md).                                                                                                                                  |
| Distributed Transaction - Saga Pattern          | Data management              | If a local transaction fails because it violates a business rule then the [saga](../7_ArchitecturePatterns/Saga.md) executes a series of compensating transactions that undo the changes that were made by the preceding local transactions.                                                                                 |
| Distributed Transaction - Transactional outbox  | Data management              | Service that sends the message to first store the message in the database as part of the transaction that updates the business entities. A separate process then sends the messages to the message broker. [Read more](https://microservices.io/patterns/data/transactional-outbox.html)           |
| Command Query Responsibility Segregation (CQRS) | Data management              | [CQRS](../7_ArchitecturePatterns/CQRS.md) define a view database, which is a **read-only replica** that is designed to support that query.                                                                                                                                                                                   |
| Event sourcing                                  | Data management              | [Event sourcing](../7_ArchitecturePatterns/EventSourcing.md) persists the state of a business entity such an Order or a Customer as a sequence of state-changing events.                                                                                                                                                     |
| Asynchronous Messaging                          | Communication - Style        | In asynchronous messaging, [Message Brokers](../2_MessageBrokersEDA) are used to pass events b/w microservices. [Read more](https://microservices.io/patterns/communication-style/messaging.html)                                                                                               |
| Synchronous Messaging                           | Communication - Style        | In synchronous messaging/request/reply-based protocol, [gRPC](../8_API-Protocols/gRPC.md) or [REST](../8_API-Protocols/REST.md) are used for inter-service communication.                                                                                                                      |
| Circuit Breaker                                 | Reliability                  | In [circuit breaker](../7_ArchitecturePatterns/CircuitBreaker.md), a remote service is invoked via a proxy that fails immediately when the failure rate of the remote call exceeds a threshold.                                                                                                |
| Retry & timeout pattern                         | Reliability                  | Do only the limited numbers of [retry](../7_ArchitecturePatterns/RetryExponenialBackoff/RetryPattern.md) on failure and make a timeout after retry.                                                                                                                                                                   |
| API Gateway                                     | Communication - External API | [API gateway](1_APIGateway/Readme.md) provides each client with unified interface to services. [Read more](https://microservices.io/patterns/apigateway.html)                                                                                                                                   |
| Service Registry & discovery                    | Communication                | The router queries a [service registry](2_ServiceRegistry&Discovery/Readme.md) (a database of service instance locations) to discover the locations of service instances. [Read more](https://microservices.io/patterns/server-side-discovery.html)                                             |
| Logging & monitoring                            | Observability                | [New Relic](https://github.com/Anshul619/DevOps-SRE/tree/main/3_Observability/NewRelic/Readme.md), [ELK](https://github.com/Anshul619/DevOps-SRE/tree/main/3_Observability/ELK.md) etc can be used for logging and observation of microservices. [Read more](https://microservices.io/patterns/observability/application-logging.html)                                   |
| Distributed Tracing                             | Observability                | [New Relic](https://github.com/Anshul619/DevOps-SRE/tree/main/3_Observability/NewRelic/Readme.md), [AWS AppMesh](https://github.com/Anshul619/AWS-Services/tree/main/16_NetworkingAndContentDelivery/2_ApplicationNetworking/AWSAppMesh.md) can be used as [service mesh](ServiceMesh.md) for distributed tracing.                                                |
| Service instance per container                  | Deployment patterns          | Use [Container orchestration service](https://github.com/Anshul619/DevOps-SRE/tree/main/2_ContainerOrchestration/Readme.md) for container deployments. Example - [Kubernates](https://github.com/Anshul619/DevOps-SRE/tree/main/2_ContainerOrchestration/Kubernates/Readme.md), [AWS ECS](https://github.com/Anshul619/AWS-Services/tree/main/3_ContainerOrchestration/AmazonECS/Readme.md) etc. |
| Session                                         | Security                     | [Redis](../1_Databases/8_Caching-InMemory-Databases/Redis) can be used to share the session data between microservices.                                                                                                                                                                          |
| Access token                                    | Security                     | [API Gateway](1_APIGateway/Readme.md) authenticates the request and passes an access token (e.g. JSON Web Token) that securely identifies the requester in each request to the services. <br/>- A service can include the access token in requests it makes to other services.                  |

# Read more
- [A pattern language for microservices](https://microservices.io/patterns/)
- [Microservice Pitfalls: Solving the Dual-Write Problem | Designing Event-Driven Microservices](https://www.youtube.com/watch?v=4GffyiSZri4)

