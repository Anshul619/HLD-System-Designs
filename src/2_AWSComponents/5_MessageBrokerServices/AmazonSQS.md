# Amazon SQS (Simple Queue Service)
- [Amazon SQS (Simple Queue Service)](https://aws.amazon.com/sqs/) is a fully managed message queuing service that enables you to [decouple and scale microservices](../../1_HLDDesignComponents/1_MicroServicesSOA/Readme.md), [distributed systems](../../1_HLDDesignComponents/0_SystemGlossaries/Readme.md), and serverless applications.
- :star: [Amazon SQS vs others](../../1_HLDDesignComponents/4_MessageBrokers/KafkaVsRabbitMQVsSQSVsSNS.md)

![img.png](assests/sns/FanOutPatternSQSSNS.png)

# Key Features

![img.png](assests/sqs/SQS-DLD-More-Info.png)

| Feature                                                                                                                | Descriptions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| At-least-Once delivery (using Visibility Timeout)                                                                      | Unlike a [publish-subscribe system](../../1_HLDDesignComponents/4_MessageBrokers/Readme.md), a single message should be delivered to a single consumer, even when there are a lot of consumers running concurrently (also known as the [competing consumers pattern](https://www.conceptdraw.com/examples/message-queue)).<br/>- When a message is being received by a consumer/worker, it is blocked from being visible to other consumers for a given period of time (known as [Visibility Timeout](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-visibility-timeout.html)).<br/>- If the message isn't deleted before this timeout elapses, it will be visible again to all consumers. |
| Dead-Letter Queue                                                                                                      | [Amazon SQS]() supports [dead-letter queues (DLQ)](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-dead-letter-queues.html), which other queues (source queues) can target for messages that can't be processed (consumed) successfully.<br/>- After [maxReceiveCount](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-dead-letter-queues.html), message would be pushed in the configured dead letter queue.                                                                                                                                                                                                                                                |
| APIs Supported                                                                                                         | [Amazon SQS]() is a message queueing service, meaning that [it exposes an API to publish and consume messages](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-working-with-apis.html).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Highly Available                                                                                                       | [Amazon SQS]() is [highly available](../../1_HLDDesignComponents/0_SystemGlossaries/Reliability/HighAvailability.md), by default.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Inflight Messages Limit                                                                                                | [Messages are inflight](https://aws.amazon.com/premiumsupport/knowledge-center/sqs-message-backlog/) after they have been received from the queue by a consuming component, but have not yet been deleted from the queue.<br/>- Inflight messages limit - 120,000 for a standard queue, 20,000 for a FIFO queue.                                                                                                                                                                                                                                                                                                                                                                                                           |
| Queue types                                                                                                            | Amazon SQS offers two types of message queues - Standard & FIFO queues.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Message payload limit                                                                                                  | Max message payload can be 256KB in SQS queue.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [Batch Actions](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-batch-api-actions.html) | Max 10 batches                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

# SQS Queue types

|            | [Standard Queues (Out-Of-Order, Recommended, Mostly-Used)](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/standard-queues.html)                                                                                                                                                                 | [SQS FIFO queues](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/FIFO-queues.html)                                                                                                                                                                                                            |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Throughput | Unlimited Throughput                                                                                                                                                                                                                                                                                                        | High Throughput (up to [300 messages per second](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/high-throughput-fifo.html). Hence max 3000 messages per second with [max 10 batches](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-batch-api-actions.html).) |
| Delivery   | At-Least-Once Delivery                                                                                                                                                                                                                                                                                                      | [Exactly-Once Processing](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/FIFO-queues-exactly-once-processing.html)                                                                                                                                                                            |
| Ordering   | Best-Effort Ordering                                                                                                                                                                                                                                                                                                        | [First-In-First-Out Delivery](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/FIFO-queues-message-order.html)                                                                                                                                                                                  |
| Use Cases  | Decouple live user requests from intensive background work: Let users upload media while resizing or encoding it.<br/>- Allocate tasks to multiple worker nodes: Process a high number of credit card validation requests.<br/>- Batch messages for future processing: Schedule multiple entries to be added to a database. | Ensure that user-entered commands are executed in the right order.<br/>- Display the correct product price by sending price modifications in the right order.<br/>- Prevent a student from enrolling in a course before registering for an account.                                                                       |

# Amazon SQS delay queues
- [Delay queues](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-delay-queues.html) let you postpone the delivery of new messages to consumers for a number of seconds, for example, when your consumer application needs additional time to process messages.
- If you create a delay queue, any messages that you send to the queue remain invisible to consumers for the duration of the delay period.
- The default (minimum) delay for a queue is 0 seconds.
- The maximum is 15 minutes.

![](https://docs.aws.amazon.com/images/AWSSimpleQueueService/latest/SQSDeveloperGuide/images/sqs-delay-queues-diagram.png)

# References
- [Amazon's SQS performance and latency](https://softwaremill.com/amazon-sqs-performance-latency/)
- [SQS vs SNS vs Amazon MQ - Comparison - AWS Certification Cheat Sheet](https://cloud.in28minutes.com/aws-certification-sqs-vs-sns-vs-amazon-mq)