# Amazon Simple Storage Service (S3)
- [Amazon S3](https://aws.amazon.com/s3/) is an object store (flat-structure), meaning it is a higher layer data storage system, essentially [it is a database "blob" storage](https://www.techopedia.com/definition/32166/blob-storage), storing data in an underlying simple database as an object.
- It's designed for [WRITE once READ many access i.e. append-only data structure](../../../1_HLDDesignComponents/0_SystemGlossaries/Database/AppendOnlyDataStructure.md), perfect for [Static content](../../../1_HLDDesignComponents/0_SystemGlossaries/CDNs/StaticContentWithCDN.md).
- It's [distributed](../../../1_HLDDesignComponents/0_SystemGlossaries/Readme.md) and offers a very high level of redundancy i.e. [data is stored in 3 AZs within a specific region](../../AWS-Global-Architecture-Region-AZ.md).
- :star: [S3 vs Others](../S3vsEFSvsEBS.md)

# Amazon S3 use cases

| Use Case           | Description                                                                                                                                                                                                                                                                                                                                                                                                                     |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Backup and storage | Amazon S3 is a natural place to back up files because it is highly redundant. As mentioned in the last unit, AWS stores your EBS snapshots in S3 to take advantage of its high availability.                                                                                                                                                                                                                                    |
| Media hosting      | Because you can store unlimited objects, and each individual object can be up to 5 TBs, Amazon S3 is an ideal location to host video, photo, and music uploads.                                                                                                                                                                                                                                                                 |
| Software delivery  | You can use Amazon S3 to host your software applications that customers can download.                                                                                                                                                                                                                                                                                                                                           |
| Data lakes         | Amazon S3 is an optimal foundation for a data lake because of its virtually unlimited scalability. <br/>- You can increase storage from gigabytes to petabytes of content, paying only for what you use.                                                                                                                                                                                                                        |
| Data Catalog       | You can create the comprehensive data catalog by using standard AWS services like AWS Lambda, Amazon DynamoDB, and Amazon Elasticsearch Service (Amazon ES). <br/>- At a high level, you can use Lambda triggers to populate DynamoDB tables with object names and metadata. <br/>- When those objects are put into Amazon S3 then Amazon ES is used to search for specific assets, related metadata, and data classifications. |
| Static websites    | You can configure your S3 bucket to host a static website of HTML, CSS, and client-side scripts.                                                                                                                                                                                                                                                                                                                                |
| Static content     | Because of the limitless scaling, the support for large files, and the fact that you access any object over the web at any time, Amazon S3 is the perfect place to store static content.                                                                                                                                                                                                                                        |

# :star: Real world use cases of Amazon S3

## :star: Amazon S3 + Amazon CloudFront: A Match Made in the Cloud
- Instead of [directly accessing the S3 resource](https://aws.amazon.com/blogs/networking-and-content-delivery/amazon-s3-amazon-cloudfront-a-match-made-in-the-cloud/), we should use [CloudFront distribution](../../1_NetworkingAndContentDelivery/AmazonCloudFront.md) in the middle (which acts as a [CDN](../../../1_HLDDesignComponents/0_SystemGlossaries/CDNs/CDNs.md))

![img.png](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2018/06/27/4-v-2.png)

## Upload Image using Amazon S3 and Lambda

![img.png](../../0_AWSDesigns/DesignUploadImageAWSLambdaS3/assets/UploadImage-Lambda.drawio.png)

[Read more](../../0_AWSDesigns/DesignUploadImageAWSLambdaS3/README.md)

## Hosting a static website using Amazon S3 & CloudFront
- You can use [Amazon S3 to host a static website](https://docs.aws.amazon.com/AmazonS3/latest/userguide/WebsiteHosting.html).
- [On a static website, individual webpages include static content](../../../1_HLDDesignComponents/0_SystemGlossaries/CDNs/StaticContentWithCDN.md).
- They might also contain client-side scripts.

By contrast, a dynamic website relies on server-side processing, including server-side scripts, such as PHP, JSP, or ASP.NET.
- [Amazon S3]() does not support server-side scripting, but AWS has other resources for hosting dynamic websites.

![img.png](https://d2908q01vomqb2.cloudfront.net/cb4e5208b4cd87268b208e49452ed6e89a68e0b8/2017/11/06/1-1024x576.png)

[Read more](../../0_AWSDesigns/WPSiteCloudFront&S3.md)

## IoT sensor data capture architecture
- Capturing data from thousands of Internet of Things (IoT) sensors can be a challenge. 
- This architecture represents one solution to this challenge.

![](assets/AWS-IOT-Data-Capture.png)

# Key Features of S3

| Feature                                                                                                                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|-----------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Highly durable](../../../1_HLDDesignComponents/0_SystemGlossaries/Database/Durability.md)                                        | -                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [Great for static assets](../../../1_HLDDesignComponents/0_SystemGlossaries/CDNs/StaticContentWithCDN.md)                         | -                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [Infinitely scalable](../../../1_HLDDesignComponents/0_SystemGlossaries/Scalability/DBScalability.md)                             | -                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [Object-based storage](https://www.techopedia.com/definition/32166/blob-storage)                                                  | -                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Objects up to 5TB in size                                                                                                         | When uploading data via the AWS Management Console, the maximum file that you can upload is 160GB. <br/>- To upload a file larger than 160 GB, use the AWS CLI, AWS SDK, or Amazon S3 REST API.                                                                                                                                                                                                                                              |
| [Encryption at rest & in transit](https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html)                   | [Amazon S3]() also offers integrations to help prevent breaches by way of PCI-DSS, HIPAA/HITECH, and FedRAMP.                                                                                                                                                                                                                                                                                                                                |
| [Buckets](S3Bucket.md)                                                                                                            | Buckets are permanent containers that hold objects.                                                                                                                                                                                                                                                                                                                                                                                          |
| [Versioning](https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html)                                               | Versioning is a means of keeping multiple variants of an object in the same bucket.<br/>- If you enable versioning for a bucket, Amazon S3 automatically generates a unique version ID for the object being stored. <br/>- In one bucket, for example, you can have two objects with the same key, but different version IDs.                                                                                                                |
| [Cross-Region Replication (CRR)](../../AWS-Global-Architecture-Region-AZ.md)                                                      | Cross-Region replication is a bucket-level configuration that enables automatic, asynchronous copying of objects across buckets in different AWS Regions.                                                                                                                                                                                                                                                                                    |
| [Same-Region Replication (SRR)](https://aws.amazon.com/about-aws/whats-new/2019/09/amazon-s3-introduces-same-region-replication/) | Amazon S3 supports automatic and asynchronous replication of newly uploaded S3 objects to a destination bucket in the same AWS Region.                                                                                                                                                                                                                                                                                                       |
| [S3 Strong data consistency model](https://aws.amazon.com/s3/consistency/)                                                        | After a successful write of a new object or overwrite of an existing object, any subsequent read request immediately receives the latest version of the object. <br/>- Amazon S3 also provides strong consistency for list operations, so after a write, you can immediately perform a listing of the objects in a bucket with any changes reflected.                                                                                        |
| Automatic event on adding file in S3                                                                                              | [Granting permissions in S3 to publish event notification messages to a destination (Lambda, SQS, SNS etc.)](https://docs.aws.amazon.com/AmazonS3/latest/userguide/grant-destinations-permissions-to-s3.html)                                                                                                                                                                                                                                |
| Analyse data using [Amazon Athena](AmazonAthena.md)                                                                               | Amazon Athena is a serverless, interactive analytics service built on open-source frameworks, supporting open-table and file formats. <br/>- Athena provides a simplified, flexible way to analyze petabytes of data where it lives. <br/>- Analyze data or build applications from an Amazon Simple Storage Service (S3) data lake and 25-plus data sources, including on-premises data sources or other cloud systems using SQL or Python. |
| [S3 Multipart Upload](https://docs.aws.amazon.com/AmazonS3/latest/userguide/mpuoverview.html)                                     | Multipart upload allows you to upload a single object as a set of parts. <br/>- Each part is a contiguous portion of the object's data. <br/>- You can upload these object parts independently and in any order.                                                                                                                                                                                                                             |

## Cross-Region Supported

![img.png](https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/01/1_SMawCtVcSkQ6ZaQMZ0Vd7Q.png)

# S3 Cli
- It's a best practice to use aws s3 commands (such as aws s3 cp) for multipart uploads and downloads, because these [aws s3 commands automatically perform multipart uploading and downloading based on the file size](https://repost.aws/knowledge-center/s3-multipart-upload-cli).

| Name                 | Command                            | Remarks                                                                                                                                                 |
|----------------------|------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|
| Copy file            | aws s3 cp command                  | In this command, you use the aws s3 cp command to copy the whale.jpg file from the client local machine in c:\sourcefiles to the demo-oceanlife bucket. |
| List files           | aws s3 ls                          | -                                                                                                                                                       |
| List files in bucket | aws s3 ls *bucketname*             | -                                                                                                                                                       |
| Move file            | -                                  | -                                                                                                                                                       |
| Sync folder          | aws s3 sync <source> <destination> | -                                                                                                                                                       |

[Read more](https://docs.aws.amazon.com/cli/latest/reference/s3/)

# Amazon S3 Storage Classes

| Name                                                                                                                                                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                    |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Amazon S3 Glacier storage classes](https://aws.amazon.com/s3/storage-classes/glacier/)                                                                        | The [Amazon S3 Glacier](https://aws.amazon.com/s3/storage-classes/glacier/) storage classes are purpose-built for data archiving, providing you with the highest performance, most retrieval flexibility, and the lowest cost archive storage in the cloud.                                                                                                                                                                    |
| [Amazon S3 Glacier Deep Archive](https://aws.amazon.com/s3/storage-classes/)                                                                                                                                 | S3 Glacier Deep Archive is Amazon S3’s lowest-cost storage class and supports long-term retention and digital preservation for data that may be accessed once or twice in a year. <br/>- It is designed for customers—particularly those in highly-regulated industries, such as financial services, healthcare, and public sectors—that retain data sets for 7—10 years or longer to meet regulatory compliance requirements. |
| [S3 Standard-Infrequent Access (S3 Standard-IA)](https://aws.amazon.com/s3/storage-classes/)                                                                   | S3 Standard-IA is for data that is accessed less frequently, but requires rapid access when needed. S3 Standard-IA offers the high durability, high throughput, and low latency of S3 Standard, with a low per GB storage price and per GB retrieval charge.                                                                                                                                                                   |
| [S3 One Zone-Infrequent Access](https://aws.amazon.com/about-aws/whats-new/2018/04/announcing-s3-one-zone-infrequent-access-a-new-amazon-s3-storage-class/)    | S3 One Zone-Infrequent Access (S3 One Zone-IA; Z-IA) is a new storage class designed for customers who want a lower-cost option for infrequently accessed data, but do not require the multiple Availability Zone data resilience model of the S3 Standard and S3 Standard-Infrequent Access (S3 Standard-IA; S-IA) storage classes.                                                                                           |

# Data Transfer Services

| Service                                                                                                                        | Description                                                                                                                                                                                                                                                                                                                                                                               |
|--------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [AWS DataSync](https://aws.amazon.com/datasync/)                                                                               | AWS DataSync makes it simple and fast to move large amounts of data online between on-premises storage and Amazon S3.                                                                                                                                                                                                                                                                     |
| [AWS Transfer Family](https://aws.amazon.com/aws-transfer-family/)                                                             | The AWS Transfer Family provides fully managed support for file transfers directly into and out of Amazon S3.<br/>- Supports SFTP, FTPS protocols.                                                                                                                                                                                                                                        |
| [Amazon S3 Transfer Acceleration](https://aws.amazon.com/s3/transfer-acceleration/)                                            | You can use [Amazon S3 Transfer Acceleration](https://aws.amazon.com/s3/transfer-acceleration/) for fast, easy, and secure transfers of files over long distances.                                                                                                                                                                                                                                                                            |
| :star: [Amazon Kinesis Data Firehose](../../10_BigDataComponents/StreamProcessing/AmazonKinesis/AmazonKinesisDataFirehouse.md) | You can also stream data into Amazon S3 by using Amazon Kinesis Data Firehose, a fully managed streaming service. <br/>- Because it captures and automatically loads streaming data in Amazon S3 and Amazon Redshift, you get near-real-time analytics with the business intelligence tools that you already use.                                                                         |
| [Amazon Kinesis Data Streams (KDS)](../../5_MessageBrokerServices/AmazonKinesisDataStreams.md)                                 | You can also emit data from Kinesis Data Streams to other AWS services, such as Amazon S3, Amazon Redshift, Amazon EMR, and AWS Lambda.<br/>- Kinesis Data Streams can continuously capture and store terabytes of data per hour from hundreds of thousands of sources, such as website clickstreams, financial transactions, social media feeds, IT logs, and location -tracking events. |
| [Amazon Partner Network](https://aws.amazon.com/partners/)                                                                     | You can use third-party connectors from the Amazon Partner Network for additional Amazon transfer service support.                                                                                                                                                                                                                                                                        |

# Securing Data Access

| Security Mechanism                                                                                    | Description                                                                                                                                                                                                                                                  |
|-------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [AWS IAM](../../2_SecurityAndIdentityServices/AWSUsers&AccessMgmt/AWSIAM.md)                                                                                               | IAM is used to create users and manage their respective access to resources, including buckets and objects.                                                                                                                                                  |
| Bucket policies                                                                                       | Bucket policies are used to configure permissions for all or a subset of objects using tags and prefixes.                                                                                                                                                    |
| [Pre-Signed URLs](https://docs.aws.amazon.com/AmazonS3/latest/userguide/ShareObjectPreSignedURL.html) | Pre-Signed URLs are used to grant time-limited access to others with temporary URLs.                                                                                                                                                                         |
| Access Control List (ACLs)                                                                            | Access Control List (ACLs) to make individual objects accessible to authorized users.<br/>- Note: Amazon S3 ACLs are a legacy access control mechanism that predates IAM. AWS recommends using Amazon S3 bucket policies or IAM policies for access control. |

# References
- [Append data to an S3 object](https://stackoverflow.com/questions/41783903/append-data-to-an-s3-object)